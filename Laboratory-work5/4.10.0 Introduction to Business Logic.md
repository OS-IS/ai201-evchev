# WSTG - Стабільний

## Вступ до бізнес-логіки

Тестування бізнес-логіки багатофункціонального динамічного веб-додатку вимагає нестандартного мислення. Якщо механізм аутентифікації додатку розроблений з наміром виконати кроки 1, 2, 3 саме в такому порядку, щоб аутентифікувати користувача, то що станеться, якщо користувач перейде одразу до кроку 3? Що станеться, якщо користувач перейде з кроку 1 відразу до кроку 3? У цьому спрощеному прикладі програма надасть доступ, не відкривши його; відмовить у доступі або просто видасть помилку з повідомленням 500?

Можна навести багато прикладів, але єдиний незмінний урок полягає в тому, щоб «мислити поза межами загальноприйнятої мудрості». Цей тип вразливостей не може бути виявлений сканером вразливостей і покладається на навички та креативність тестувальника на проникнення. Крім того, цей тип вразливостей, як правило, є одним з найскладніших для виявлення, і, як правило, є специфічним для конкретного додатку, але, в той же час, зазвичай є одним з найбільш шкідливих для додатку, якщо його експлуатувати.

Класифікація вразливостей бізнес-логіки недостатньо вивчена; хоча експлуатація бізнес-вразливостей часто трапляється в реальних системах, і багато дослідників прикладних вразливостей досліджують їх. Найбільша увага приділяється веб-додаткам. У спільноті точаться дискусії про те, чи є ці проблеми особливо новими концепціями, чи вони є варіаціями добре відомих принципів.

Тестування недоліків бізнес-логіки схоже на типи тестів, що використовуються функціональними тестувальниками, які зосереджені на логічному тестуванні або тестуванні кінцевих станів. Ці типи тестів вимагають від фахівців з безпеки трохи іншого мислення, розробки кейсів зловживань і неправильного використання та використання багатьох методів тестування, які застосовують функціональні тестувальники. Автоматизація випадків зловживання бізнес-логікою неможлива і залишається ручним мистецтвом, що покладається на навички тестувальника та його знання повного бізнес-процесу і його правил.

## Бізнес-ліміти та обмеження

Подумайте про правила для бізнес-функції, яку виконує додаток. Чи існують якісь ліміти або обмеження на поведінку людей? Потім подумайте, чи забезпечує додаток дотримання цих правил. Зазвичай досить легко визначити тестові та аналітичні кейси для перевірки додатку, якщо ви знайомі з бізнесом. Якщо ви сторонній тестувальник, то вам доведеться використовувати свій здоровий глузд і запитати бізнес, чи повинні бути дозволені різні операції в додатку.

Іноді, у дуже складних додатках, тестувальник не має повного розуміння кожного аспекту програми на початковому етапі. У таких ситуаціях найкраще, щоб клієнт провів тестувальника через додаток, щоб він міг краще зрозуміти обмеження і передбачувану функціональність додатку до початку тестування. Крім того, наявність прямого зв'язку з розробниками (якщо це можливо) під час тестування дуже допоможе, якщо виникнуть будь-які питання щодо функціональності додатку.

## Виклики логічного тестування
Автоматизованим інструментам важко зрозуміти контекст, тому такі тести має виконувати людина. Наступні два приклади ілюструють, як розуміння функціональності програми, намірів розробника і трохи творчого «нестандартного» мислення можуть порушити логіку програми. Перший приклад починається зі спрощеної маніпуляції з параметрами, тоді як другий є реальним прикладом багатоетапного процесу, що призводить до повного підриву програми.

#### Приклад 1:

Припустимо, що сайт електронної комерції дозволяє користувачам вибирати товари для купівлі, переглядати підсумкову сторінку, а потім виставляти пропозицію на продаж. Що, якщо зловмисник зможе повернутися на підсумкову сторінку, зберігаючи ту ж саму дійсну сесію, ввести нижчу ціну за товар, завершити транзакцію, а потім вийти з системи?

#### Приклад 2:

Утримання/блокування ресурсів і утримання інших від купівлі цих товарів в Інтернеті може призвести до того, що зловмисники купуватимуть товари за нижчою ціною. Контрзаходом для вирішення цієї проблеми є впровадження тайм-аутів і механізмів, які гарантують, що буде стягуватися лише правильна ціна.

#### Приклад 3:

Що робити, якщо користувач зміг розпочати транзакцію, прив'язану до свого клубного рахунку/рахунку лояльності, а потім, після того, як бали були додані на його рахунок, скасувати транзакцію? Чи будуть бали/кредити все ще застосовані до його рахунку?

## Інструменти

Хоча існують інструменти для тестування та перевірки правильності функціонування бізнес-процесів у допустимих ситуаціях, ці інструменти не здатні виявити логічні вразливості. Наприклад, інструменти не можуть виявити, чи може користувач обійти потік бізнес-процесу шляхом редагування параметрів, передбачення імен ресурсів або підвищення привілеїв для доступу до ресурсів з обмеженим доступом, а також не мають жодного механізму, який би допоміг тестувальнику запідозрити такий стан речей.

Нижче наведено кілька поширених типів інструментів, які можуть бути корисними для виявлення проблем бізнес-логіки.

Встановлюючи доповнення, ви завжди повинні бути уважними, враховуючи дозволи, які вони запитують, і звички використання вашого браузера.

### Перехоплення проксі

Спостереження за блоками запитів і відповідей HTTP-трафіку
- [OWASP Zed Attack Proxy](https://www.zaproxy.org/)
- [Відрижка проксі](https://portswigger.net/burp)

### Плагіни для веб-браузерів

Для перегляду та зміни заголовків HTTP/HTTPS, параметрів постів та спостереження за DOM браузера
- [Дані про несанкціонований доступ до FF Quantum](https://addons.mozilla.org/en-US/firefox/addon/tamper-data-for-ff-quantum/)
- [Tamper Chrome (для Google Chrome)](https://chromewebstore.google.com/detail/tamper-chrome-extension/hifhgpdkfodlpnlmlnmhchnkepplebkb)

## Різні тестові інструменти
- [Панель інструментів веб-розробника](https://chromewebstore.google.com/detail/web-developer/bfbameneiokkgbdmiekhjnmfkcnldhhm)
* Розширення Web Developer додає до браузера кнопку на панелі інструментів з різними інструментами для веб-розробників. Це офіційний порт розширення Web Developer для Firefox.
- [HTTP Request Maker для Chrome](https://chromewebstore.google.com/detail/request-maker/kajfghlhfkcocafkcjlajldicbikpgnp)
- [HTTP Request Maker для Firefox](https://addons.mozilla.org/en-US/firefox/addon/http-request-maker/)
* Request Maker - це інструмент для тестування на проникнення. З його допомогою ви можете легко перехоплювати запити, зроблені веб-сторінками, підробляти URL-адреси, заголовки і POST-дані і, звичайно, робити нові запити.
- [Редактор файлів cookie для Chrome](https://chromewebstore.google.com/detail/fngmhnnpilhplaeedifhccceomclgfbg)
- [Редактор файлів cookie для Firefox](https://addons.mozilla.org/en-US/firefox/addon/cookie-editor/)
* Cookie Editor - це менеджер файлів cookie. Ви можете додавати, видаляти, редагувати, шукати, захищати та блокувати файли cookie



